<odoo>
    <data>
        <template id="portal_my_courses" name="My courses">
            <t t-call="portal.portal_layout">
                <t t-set="breadcrumbs_searchbar" t-value="True"/>

                <t t-call="portal.portal_searchbar">
                    <t t-set="title">Courses</t>
                </t>


                <t t-if="not courses">
                    <p>There are currently no courses.</p>
                </t>
                <t t-if="courses" t-call="portal.portal_table">
                    <thead>
                        <tr class="active">
                            <th>Id</th>
                            <th class="text-right">Course date</th>
                            <th class="text-right">Description</th>
                            <th class="text-right">Type</th>
                            <th class="text-right">Status</th>
                            <th class="text-right">Register</th>
                        </tr>
                    </thead>
                    <t t-foreach="courses" t-as="course">
                        <tr>
                            <td class="text-right">
                                <span t-field="course.name"/>
                            </td>
                            <td class="text-right">
                                <span t-field="course.course_date"/>
                            </td>
                            <td class="text-right">
                                <span t-field="course.description"/>
                            </td>
                            <td class="text-right">
                                <span t-field="course.course_type_id"/>
                            </td>

                            <td class="text-center">
                                <t t-if="course.state == 'cancel'">
                                    <span class="badge badge-pill badge-danger">
                                        <i class="fa fa-fw fa-times" aria-label="Paid" title="Cancelled" role="img"></i>
                                        <span class="d-none d-md-inline">
                                            <span t-field="course.state"/>
                                        </span>
                                    </span>
                                </t>



                                <t t-if="course.state == 'closed'">
                                    <span class="badge badge-pill badge-warning">
                                        <i class="fa fa-fw fa-times" aria-label="Paid" title="Closed" role="img"></i>
                                        <span class="d-none d-md-inline">
                                            <span t-field="course.state"/>
                                        </span>
                                    </span>
                                </t>

                                <t t-if="course.state == 'active'">
                                    <span class="badge badge-pill badge-success">
                                        <i class="fa fa-fw fa-check" aria-label="Paid" title="Active" role="img"></i>
                                        <span class="d-none d-md-inline">
                                            <span t-field="course.state"/>
                                        </span>
                                    </span>
                                </t>
                            </td>

                            <td class="text-right">
                                <t t-foreach="course.course_students_ids.filtered(lambda r: r.id == partner.id)" t-as="student">
                                    <span t-field="student.name"/>
                                </t>

                                If allready registered show that
                                <form id="course_create" t-attf-action="/my/courses/register" method="post"
                                      class="js_website_submit_form">
                                    <div class="float-right">
                                        <button type="submit" class="btn btn-primary">Register</button>
                                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                        <input type="hidden" name="course_id" t-att-value="course.id"/>
                                    </div>
                                </form>

                            </td>

                        </tr>
                    </t>
                </t>
            </t>
        </template>



    </data>
</odoo>
